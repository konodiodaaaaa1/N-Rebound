# 📈 N-Rebound: AI-Powered A-Share Quantitative Trading System
# N-Rebound A股全自动量化交易系统 (XGBoost 增强版)

![Python](https://img.shields.io/badge/Python-3.8%2B-blue)
![XGBoost](https://img.shields.io/badge/AI-XGBoost-green)
![Strategy](https://img.shields.io/badge/Strategy-N--Rebound-orange)
![Status](https://img.shields.io/badge/Status-T%2B1%20Ready-red)

## 📖 项目简介 (Introduction)

**N-Rebound** 是一个专为中国 A 股市场（T+1 交易制度）设计的全自动量化交易系统。

本项目旨在捕捉经典的 **N 字反弹 (N-Rebound)** 形态——即主力资金介入后（涨停板），在缩量回调阶段的低吸机会。

经过多次架构迭代，系统最终摒弃了华而不实的“极短线追涨”和复杂的“深度学习”模型，回归到更适合表格数据的 **XGBoost** 决策树模型，并配合严酷的 **T+1 生存检查 (Survival Check)** 数据清洗逻辑。目前在严格风控回测下，AI 过滤器的查准率 (Precision) 稳定在 **>51%**，旨在从充满噪音的市场中筛选出具有真实 Alpha 收益的标的。

---

## 📅 技术演进路线 (Technical Evolution)

本项目并非一蹴而就，而是经过了从“深度学习迷信”到“实战逻辑优先”的深刻迭代：

### v1.0 阶段：Transformer 深度学习探索
* **尝试方案**：构建了基于 `Transformer` 架构的时序模型，试图捕捉 30 日 K 线的复杂特征。
* **遇到瓶颈**：
    1.  **噪音过敏**：Transformer 对 A 股日线级别的随机噪音过度拟合，虽然训练集表现完美，但实盘预测极其不稳定。
    2.  **维度错配**：对于只有 "开/高/低/收/量" 5 个特征的表格数据，深度学习模型缺乏可解释性，且推理资源消耗大。
    3.  **T+1 陷阱**：旧版打标逻辑未剔除“日内触及止损后拉回”的假阳性样本，导致回测虚高。

### v2.0 阶段：极短线追涨策略（已废弃）
* **尝试方案**：模仿游资手法，尝试“早盘高开突击”策略。
* **验证结果**：通过对过去两年 10 万条数据的暴力回测，发现该策略在 T+1 制度下胜率仅为 **36%**。大多数高开个股当天冲高回落，次日低开直接闷杀。此路不通。

### v3.0 阶段：XGBoost + 严格 T+1 风控 (当前版本)
* **最终方案**：回归 N 字波段策略，切换至 **XGBoost** 树模型，并重构数据清洗逻辑。
* **核心优势**：
    1.  **抗噪性强**：树模型天然适合低维度的表格数据，能有效过滤无效波动。
    2.  **可解释性**：AI 明确给出了因子重要性排序（如“30日涨幅”权重最高），让策略逻辑透明化。
    3.  **生存偏差修正**：`dataset_maker` 引入了严酷的生存检查——如果次日开盘或盘中触及止损，直接判定为负样本。AI 学会了“先活下来，再谈赚钱”。

---

## ✨ 核心特性 (Key Features)

* **🤖 XGBoost 决策引擎**：利用梯度提升树强大的特征组合能力，精准过滤 N 字回调中的假企稳信号。
* **🛡️ 严格的 T+1 风控**：强制执行 T+1 锁仓逻辑，模拟盘严格遵守“止盈 8% / 止损 -5%”纪律。
* **💤 懒人全自动模式**：
    * **智能唤醒**：集成 `launcher.py`，自动判断选股文件是否过期，过期自动重跑，未过期直接交易。
    * **休市睡眠**：盘中自动识别交易时间，午休和收盘后自动进入低功耗休眠，开盘前 5 分钟自动唤醒。
    * **断点续传**：支持盘中意外断电/重启，系统会自动读取本地持仓文件恢复交易状态。
* **📊 自动审计**：每日盘后一键生成盈亏审计报告 (`paper_review.py`)。

---

## 🏗️ 系统架构 (Architecture)

1.  **选股雷达 (`night_screener.py`)**: 
    * **时机**：每日收盘后。
    * **任务**：扫描全市场，筛选出符合“涨停后缩量回调”形态的候选股。
2.  **AI 参谋部 (`ai_filter.py`)**: 
    * **内核**：XGBoost Classifier。
    * **任务**：加载训练好的 `.model` 文件，实时计算 7 大关键因子（如乖离率、量比），预测上涨概率。
3.  **交易执行端 (`paper_bot.py`)**: 
    * **时机**：9:30 - 15:00。
    * **任务**：实时监控 AI 选中的股票，触发买入阈值（0.5%~3.0%）自动模拟交易。
4.  **数据工厂 (`dataset_maker.py` + `train_xgboost.py`)**:
    * **任务**：负责从历史数据中清洗出“幸存者样本”，并重新训练 AI 模型。

---

## 🛠️ 快速开始 (Quick Start)

### 1. 环境准备
```bash
pip install pandas numpy xgboost scikit-learn akshare joblib
# 可选: 安装 torch 用于对比测试
pip install torch
````

### 2\. 日常使用 (Daily Workflow)

**方式 A：懒人一键启动（推荐）**
直接双击运行根目录下的批处理文件：

  * `一键开工.bat`：智能判断是否需要选股，随后启动交易机器人。
  * `查看今日战绩.bat`：盘后查看当天的模拟盈亏和持仓明细。

**方式 B：手动分步运行**

```bash
# 1. 晚上运行选股
python night_screener.py

# 2. 盘中运行机器人 (会自动读取生成的 CSV)
python paper_bot.py
```

-----

## 🧠 策略逻辑详解 (Strategy Logic)

### N 字反弹 (The N-Rebound)

主力资金拉升涨停（第一笔画），随后缩量洗盘回调（第二笔画），我们博弈的是再次拉升（第三笔画）。

  * **买点**：回调不破启动位，且 AI 判定胜率 \> 50%。
  * **卖点**：
      * **止盈**：+8% (吃主升浪鱼身)
      * **止损**：-5% (给主力洗盘空间，防止被噪音震出)

### AI 核心因子 (Top Features by Importance)

XGBoost 模型分析显示，以下因子最为关键：

1.  **30日涨幅**：确保个股处于中期主升浪趋势中。
2.  **量比**：确认资金活跃度，避免买入死水股。
3.  **MA5 偏离度**：寻找回调到位的“黄金坑”。

-----

## 📂 文件结构说明

  * `paper_bot.py`: **[核心]** 自动交易机器人主程序。
  * `ai_filter.py`: **[核心]** AI 推理接口，负责加载 XGBoost 模型。
  * `night_screener.py`: N字策略选股脚本。
  * `train_xgboost.py`: 模型训练脚本（包含特征工程）。
  * `dataset_maker.py`: 数据清洗与打标脚本（含 T+1 风控逻辑）。
  * `launcher.py`: 智能调度启动器。
  * `web_monitor.py`: 可视化监控前端。

-----

## ⚠️ 免责声明 (Disclaimer)

本项目仅供计算机编程与量化策略研究使用。

  * 项目中的“模拟交易”不涉及真实资金。
  * A 股市场风险巨大，**请勿将本系统直接用于实盘交易**。
  * 作者不承担任何因使用本软件导致的资金损失。

-----

*Created by konodiodaaaaa1 with Gemini Assistant.*

```
```
